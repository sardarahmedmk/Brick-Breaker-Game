<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ translations.get('store_title', 'E-Commerce Store') }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="logo">{{ translations.get('store_name', 'E-Store') }}</div>
            <div class="nav-center">
                <a href="/?lang={{ lang }}&currency={{ currency }}">{{ translations.get('home', 'Home') }}</a>
                <a href="#products">{{ translations.get('products', 'Products') }}</a>
                <a href="/cart?lang={{ lang }}&currency={{ currency }}">{{ translations.get('cart', 'Cart') }}</a>
                <a href="/orders?lang={{ lang }}&currency={{ currency }}">{{ translations.get('my_orders', 'My Orders') }}</a>
            </div>
            <div class="nav-right">
                <select id="langSelect" onchange="changeLanguage(this.value)">
                    <option value="en" {% if lang == 'en' %}selected="selected"{% endif %}>English</option>
                    <option value="ur" {% if lang == 'ur' %}selected="selected"{% endif %}>ÿßÿ±ÿØŸà</option>
                </select>
                <select id="currencySelect" onchange="changeCurrency(this.value)">
                    <option value="USD" {% if currency == 'USD' %}selected="selected"{% endif %}>USD</option>
                    <option value="EUR" {% if currency == 'EUR' %}selected="selected"{% endif %}>EUR</option>
                    <option value="GBP" {% if currency == 'GBP' %}selected="selected"{% endif %}>GBP</option>
                    <option value="PKR" {% if currency == 'PKR' %}selected="selected"{% endif %}>PKR</option>
                    <option value="INR" {% if currency == 'INR' %}selected="selected"{% endif %}>INR</option>
                </select>
                <a href="/cart?lang={{ lang }}&currency={{ currency }}" class="cart-icon">üõí <span id="cartCount">0</span></a>
            </div>
        </div>
    </nav>

    <header class="hero">
        <div class="hero-content">
            <h1>{{ translations.get('welcome', 'Welcome to Our Store') }}</h1>
            <p>{{ translations.get('hero_subtitle', 'Quality Products at Great Prices') }}</p>
        </div>
    </header>

    <main class="container">
        <section id="products" class="products-section">
            <h2>{{ translations.get('featured_products', 'Featured Products') }}</h2>
            <div class="products-grid">
                {% for product in products %}
                <div class="product-card">
                    <div class="product-image">
                        <img src="{{ url_for('static', filename='images/' + product.image) }}" alt="{{ product.name }}" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <div class="product-info">
                        <h3>{{ product.name }}</h3>
                        <p class="description">{{ product.description }}</p>
                        <div class="rating">
                            <span class="stars">‚≠ê {{ product.rating }}</span>
                            <span class="reviews">({{ product.reviews }} {{ translations.get('reviews', 'reviews') }})</span>
                        </div>
                        <div class="price-section">
                            <span class="price">{{ currency }} {{ "%.2f"|format(product.price) }}</span>
                            <button class="btn-add-cart" onclick="addToCart({{ product.id }}, '{{ product.name }}', {{ product.price }}, '{{ lang }}', '{{ currency }}')">
                                {{ translations.get('add_to_cart', 'Add to Cart') }}
                            </button>
                        </div>
                        <a href="/product/{{ product.id }}?lang={{ lang }}&currency={{ currency }}" class="btn-view">
                            {{ translations.get('view_details', 'View Details') }}
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 E-Commerce Store. {{ translations.get('all_rights', 'All Rights Reserved') }}</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script>
        function changeLanguage(lang) {
            window.location.href = `/?lang=${lang}&currency={{ currency }}`;
        }

        function changeCurrency(currency) {
            window.location.href = `/?lang={{ lang }}&currency=${currency}`;
        }

        function addToCart(id, name, price) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let item = cart.find(p => p.id === id);
            
            if (item) {
                item.quantity += 1;
            } else {
                cart.push({ id, name, price, quantity: 1 });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            alert('{{ translations.get("item_added", "Item added to cart!") }}');
        }

        function updateCartCount() {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        updateCartCount();
    </script>
</body>
</html>
